var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var wavesurfer,context,processor;document.addEventListener('DOMContentLoaded',function(){var micBtn=document.querySelector('#micBtn');micBtn.onclick=function(){if(wavesurfer===undefined){if(isSafari){var AudioContext=window.AudioContext||window.webkitAudioContext;context=new AudioContext();processor=context.createScriptProcessor(1024,1,1)}
wavesurfer=WaveSurfer.create({container:'#waveform',waveColor:'green',interact:!1,cursorWidth:0,audioContext:context||null,audioScriptProcessor:processor||null,plugins:[WaveSurfer.microphone.create()]});wavesurfer.microphone.on('deviceReady',function(){console.info('Device ready!')});wavesurfer.microphone.on('deviceError',function(code){console.warn('Device error: '+code)});wavesurfer.microphone.start()}else{if(wavesurfer.microphone.active){wavesurfer.microphone.stop()}else{wavesurfer.microphone.start()}}
micBtn.style.visibility='hidden'}})